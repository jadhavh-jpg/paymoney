<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PayMoney â€“ Builder</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<style>
*{box-sizing:border-box}
body{margin:0;font-family:system-ui;background:#f1f5f9}
.wrap{max-width:1200px;margin:20px auto;padding:0 14px}
.flex{display:flex;gap:20px}
@media(max-width:900px){.flex{flex-direction:column}}
.box{background:#fff;border-radius:18px;padding:20px;width:50%}
@media(max-width:900px){.box{width:100%}}

label{font-weight:600;margin-top:12px;display:block}
input,textarea{width:100%;padding:12px;border-radius:10px;border:1px solid #ccc;margin-top:6px}
textarea{min-height:90px}

button{
  width:100%;padding:14px;border:none;border-radius:14px;
  font-size:16px;font-weight:700;cursor:pointer;margin-top:14px
}
.primary{background:#0f172a;color:#fff}
.copy{background:#020617;color:#fff}
.wa{background:#16a34a;color:#fff}

/* Preview */
.preview{text-align:center}
.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
.logo{width:64px;height:64px;border-radius:12px;background:#e5e7eb;overflow:hidden}
.logo img{width:100%;height:100%;object-fit:contain}
.reg{background:#22c55e;color:#fff;padding:10px 18px;border-radius:999px;font-weight:700}
.poster{aspect-ratio:2/3;border-radius:16px;overflow:hidden;background:#e5e7eb}
.poster img{width:100%;height:100%;object-fit:cover}
.brand{margin-top:10px;font-weight:700}
.desc{font-size:14px;color:#475569;margin-top:6px}
.note{font-size:12px;color:#64748b;margin-top:8px}
</style>
</head>

<body>

<div class="wrap">
<div class="flex">

<!-- BUILDER -->
<div class="box">
<h2>Create Payment Page</h2>

<label>Logo (optional)</label>
<input type="file" id="logoInput" accept="image/*">

<label>Poster *</label>
<input type="file" id="posterInput" accept="image/*">

<label>Title</label>
<input id="title" placeholder="3-Day Yoga Class">

<label>Description</label>
<textarea id="desc"></textarea>

<label>UPI ID *</label>
<input id="upi" placeholder="jadhav.h3@ybl">

<label>Amount (INR) *</label>
<input id="amount" type="number" placeholder="499">

<button class="primary" id="genBtn">Generate Link</button>

<input id="linkBox" readonly style="display:none;margin-top:10px">
<button class="copy" onclick="copyLink()">ðŸ“‹ Copy Link</button>
<button class="wa" onclick="shareWA()">ðŸ“¤ Share WhatsApp</button>
</div>

<!-- PREVIEW -->
<div class="box preview">
  <div class="header">
    <div class="logo" id="pLogo"></div>
    <div class="reg">Register Now</div>
  </div>
  <div class="poster" id="pPoster"></div>
  <div class="brand" id="pTitle">Title</div>
  <div class="desc" id="pDesc">Description</div>
  <div class="note">Live Preview</div>
</div>

</div>
</div>

<script>
/* ================= FIREBASE ================= */
firebase.initializeApp({
  apiKey: "AIzaSyCpfisfbj1R63LQsOdF9iCWMLCUwnMQMGA",
  authDomain: "paymoney24-cd9ad.firebaseapp.com",
  projectId: "paymoney24-cd9ad",
  storageBucket: "paymoney24-cd9ad.appspot.com"
});
const storage = firebase.storage();

/* ================= ELEMENTS ================= */
const logoInput = document.getElementById("logoInput");
const posterInput = document.getElementById("posterInput");
const titleEl = document.getElementById("title");
const descEl = document.getElementById("desc");
const upiEl = document.getElementById("upi");
const amountEl = document.getElementById("amount");

const pLogo = document.getElementById("pLogo");
const pPoster = document.getElementById("pPoster");
const pTitle = document.getElementById("pTitle");
const pDesc = document.getElementById("pDesc");
const linkBox = document.getElementById("linkBox");

let logoURL="", posterURL="", posterUploaded=false;
const pid = Date.now();

/* ================= LIVE TEXT ================= */
titleEl.oninput=()=>pTitle.innerText=titleEl.value||"Title";
descEl.oninput=()=>pDesc.innerText=descEl.value||"Description";

/* ================= IMAGE UPLOAD ================= */
function upload(file,cb){
  const ref = storage.ref("paymoney/"+Date.now()+"_"+file.name);
  ref.put(file)
    .then(s=>s.ref.getDownloadURL())
    .then(cb)
    .catch(e=>{alert("Upload failed");console.error(e)});
}

logoInput.onchange=e=>{
  const f=e.target.files[0]; if(!f)return;
  upload(f,url=>{
    logoURL=url;
    pLogo.innerHTML=`<img src="${url}">`;
  });
};

posterInput.onchange=e=>{
  const f=e.target.files[0]; if(!f)return;
  posterUploaded=false;
  upload(f,url=>{
    posterURL=url;
    posterUploaded=true;
    pPoster.innerHTML=`<img src="${url}">`;
  });
};

/* ================= GENERATE ================= */
document.getElementById("genBtn").onclick=()=>{
  if(!posterUploaded || !upiEl.value || !amountEl.value){
    alert("Poster upload complete hone do + UPI + Amount required");
    return;
  }

  const data={
    title:titleEl.value,
    desc:descEl.value,
    upi:upiEl.value,
    amount:amountEl.value,
    logo:logoURL,
    poster:posterURL
  };

  localStorage.setItem("pm_"+pid,JSON.stringify(data));

  const link=location.origin+"/landing.html?id="+pid;
  linkBox.value=link;
  linkBox.style.display="block";
};

/* ================= SHARE ================= */
function copyLink(){navigator.clipboard.writeText(linkBox.value)}
function shareWA(){window.open("https://wa.me/?text="+encodeURIComponent(linkBox.value))}
</script>

</body>
</html>
