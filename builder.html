<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PayMoney â€“ Landing Builder</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

<style>
*{box-sizing:border-box}
body{margin:0;font-family:Arial,sans-serif;background:#f5f7fb}
.wrap{max-width:1100px;margin:20px auto;padding:0 14px}
.flex{display:flex;gap:20px}
.box{background:#fff;border-radius:16px;padding:20px;width:50%}
h2,h3{margin-top:0}
label{font-weight:600;margin-top:14px;display:block}
input,textarea{
  width:100%;padding:12px;border-radius:8px;
  border:1px solid #ccc;margin-top:6px;font-size:15px
}
textarea{min-height:90px}
button{
  width:100%;padding:14px;border:none;
  border-radius:14px;font-size:16px;
  font-weight:700;cursor:pointer;
  margin-top:16px;
}
.primary{background:#0D3B66;color:#fff}
.copy{background:#2FB344;color:#fff}
.wa{background:#25D366;color:#fff}

/* preview */
.preview{border:1px solid #ddd;border-radius:16px;overflow:hidden}
.poster{aspect-ratio:2/3;background:#eee}
.poster img{width:100%;height:100%;object-fit:cover}
.c{padding:16px;text-align:center}

/* preview pay disabled */
.pay-preview{
  margin-top:14px;padding:14px;
  border-radius:14px;
  background:#2FB344;
  color:#fff;font-weight:700;
  opacity:.4;pointer-events:none
}

/* real pay */
.pay-real{
  margin-top:14px;padding:14px;
  border-radius:14px;
  background:#2FB344;
  color:#fff;font-weight:700;
  cursor:pointer;text-align:center
}

.actions{display:none;margin-top:14px}

@media(max-width:900px){
  .flex{flex-direction:column}
  .box{width:100%}
}

/* QR modal */
.qr-modal{
  position:fixed;inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:999
}
.qr-box{
  background:#fff;
  padding:20px;
  border-radius:16px;
  text-align:center;
  width:280px
}
</style>
</head>

<body>

<div class="wrap" id="builder">
<div class="flex">

<!-- BUILDER -->
<div class="box">
<h2>Create Landing</h2>

<label>Brand</label>
<input id="brand">

<label>Poster Image</label>
<input type="file" accept="image/*" onchange="loadImg(event)">

<label>Title</label>
<input id="title">

<label>Description</label>
<textarea id="desc"></textarea>

<label>UPI ID</label>
<input id="upi" placeholder="example@upi">

<label>Amount (INR)</label>
<input id="amount" type="number">

<button class="primary" onclick="generate()">Generate Landing Page</button>

<div class="actions" id="actions">
  <button class="copy" onclick="copyLink()">Copy Landing Link</button>
  <button class="wa" onclick="shareWA()">Share on WhatsApp</button>
</div>
</div>

<!-- PREVIEW -->
<div class="box">
<h3>Preview (Payment Disabled)</h3>
<div class="preview">
  <div class="poster" id="pimg"></div>
  <div class="c">
    <h3 id="ptitle">Title</h3>
    <p id="pdesc"></p>
    <div class="pay-preview">Pay Now (Preview)</div>
  </div>
</div>
</div>

</div>
</div>

<!-- QR MODAL -->
<div class="qr-modal" id="qrModal">
  <div class="qr-box">
    <h3>Scan to Pay</h3>
    <canvas id="qr"></canvas>
    <button onclick="closeQR()">Close</button>
  </div>
</div>

<script>
let imageURL="", landingLink="";

/* load image */
function loadImg(e){
  imageURL = URL.createObjectURL(e.target.files[0]);
  document.getElementById("pimg").innerHTML =
    `<img src="${imageURL}">`;
}

/* generate landing */
function generate(){
  if(!imageURL || !upi.value || !amount.value){
    alert("Image, UPI ID and Amount are required");
    return;
  }

  const upiLink =
    "upi://pay?pa=" + encodeURIComponent(upi.value) +
    "&am=" + encodeURIComponent(amount.value) +
    "&cu=INR&tn=PayMoney";

  const id = Date.now();

  localStorage.setItem(
    "landing_" + id,
    JSON.stringify({
      title: title.value,
      desc: desc.value,
      img: imageURL,
      upiLink: upiLink
    })
  );

  landingLink =
    location.origin +
    location.pathname +
    "?view=landing&id=" +
    id;

  document.getElementById("actions").style.display = "block";
  alert("Landing page created. Copy or share the link.");
}

/* copy & share */
function copyLink(){
  navigator.clipboard.writeText(landingLink);
  alert("Landing link copied");
}
function shareWA(){
  window.open(
    "https://wa.me/?text=" + encodeURIComponent(landingLink),
    "_blank"
  );
}

/* landing mode */
const q = new URLSearchParams(location.search);
if(q.get("view")==="landing"){
  const d = JSON.parse(
    localStorage.getItem("landing_" + q.get("id"))
  );
  if(!d){
    document.body.innerHTML="Invalid link";
  }else{
    document.getElementById("builder").innerHTML = `
      <div class="box">
        <img src="${d.img}" style="width:100%;border-radius:16px">
        <h3>${d.title}</h3>
        <p>${d.desc}</p>
       function pay(link){
  const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);

  if(isMobile){
    // ðŸ”¹ Try opening UPI app
    window.location.href = link;

    // ðŸ”¹ User guidance (very important)
    setTimeout(()=>{
      alert(
        "If UPI app did not open:\n\n" +
        "â€¢ Please check if Google Pay / PhonePe / Paytm is installed\n" +
        "â€¢ Try opening this link in Chrome browser\n" +
        "â€¢ Or use Scan QR option from desktop"
      );
    }, 2000);

  }else{
    // ðŸ’» Desktop â†’ QR
    QRCode.toCanvas(
      document.getElementById("qr"),
      link
    );
    document.getElementById("qrModal").style.display = "flex";
  }
}

      </div>
    `;
  }
}

/* pay logic */
function pay(link){
  if(/Mobi|Android|iPhone/i.test(navigator.userAgent)){
    window.location.href = link;        // ðŸ“± Mobile
  }else{
    QRCode.toCanvas(
      document.getElementById("qr"),
      link
    );
    document.getElementById("qrModal").style.display="flex";
  }
}
function closeQR(){
  document.getElementById("qrModal").style.display="none";
}
</script>

</body>
</html>

