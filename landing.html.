<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PayMoney â€“ Pay</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

<style>
body{margin:0;font-family:system-ui;background:#f5f7fb}
.wrap{max-width:420px;margin:20px auto;padding:16px}
.card{background:#fff;border-radius:22px;padding:18px;box-shadow:0 20px 40px rgba(0,0,0,.15)}
h2{text-align:center;margin:0 0 12px}
.poster{aspect-ratio:2/3;border-radius:16px;overflow:hidden;background:#e5e7eb}
.poster img{width:100%;height:100%;object-fit:cover}
p{font-size:14px;color:#334155}
button{
  width:100%;padding:14px;margin-top:12px;
  border:none;border-radius:14px;
  font-size:16px;font-weight:700;cursor:pointer
}
.pay{background:#22c55e;color:#fff}
.qrbtn{background:#1e40af;color:#fff}
.qr-box{text-align:center;margin-top:14px;display:none}
.note{text-align:center;font-size:13px;color:#64748b;margin-top:10px}
</style>
</head>

<body>

<div class="wrap" id="app"></div>

<script>
const q=new URLSearchParams(location.search);
const d=JSON.parse(localStorage.getItem("pm_"+q.get("id")));
if(!d){document.body.innerHTML="Invalid link";}

const upiLink=`upi://pay?pa=${encodeURIComponent(d.upi)}&pn=${encodeURIComponent(d.title||"PayMoney")}&am=${d.amount}&cu=INR`;

app.innerHTML=`
  <div class="card">
    <h2>${d.title||"PayMoney"}</h2>
    <div class="poster"><img src="${d.poster}"></div>
    <p>${d.desc||""}</p>

    <button class="pay" onclick="openUPI()">ðŸ“± Open UPI App</button>
    <button class="qrbtn" onclick="showQR()">ðŸ’» Scan QR & Pay</button>

    <div class="qr-box" id="qrBox"></div>
    <div class="note">UPI app na khule to QR scan kare</div>
  </div>
`;

function openUPI(){
  location.href=upiLink;
  setTimeout(showQR,1500);
}
function showQR(){
  const box=document.getElementById("qrBox");
  box.style.display="block";
  box.innerHTML="";
  QRCode.toCanvas(document.createElement("canvas"),upiLink,{width:240},(e,c)=>box.appendChild(c));
}
</script>

</body>
</html>
