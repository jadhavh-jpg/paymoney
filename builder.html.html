<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PayMoney – Landing Builder</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
*{box-sizing:border-box}
body{margin:0;font-family:Arial,sans-serif;background:#f5f7fb}
.wrap{max-width:1100px;margin:20px auto;padding:0 14px}
.flex{display:flex;gap:20px;align-items:flex-start}
.box{background:#fff;border-radius:16px;padding:20px;width:50%}

h2,h3{margin-top:0}

/* form */
label{font-weight:600;margin-top:14px;display:block}
input,textarea{
  width:100%;padding:12px;border-radius:8px;
  border:1px solid #ccc;margin-top:6px;font-size:15px
}
textarea{min-height:90px}

/* buttons */
button{
  width:100%;padding:14px;border:none;
  border-radius:14px;font-size:16px;
  font-weight:600;cursor:pointer;
  margin-top:16px;
}

.primary{background:#0D3B66;color:#fff}
.copy{background:#2FB344;color:#fff}
.wa{background:#25D366;color:#fff}

/* animated shine */
.anim{
  position:relative;overflow:hidden;
}
.anim::after{
  content:"";
  position:absolute;top:0;left:-100%;
  width:100%;height:100%;
  background:linear-gradient(120deg,transparent,rgba(255,255,255,.35),transparent);
  animation:shine 2.8s infinite;
}
@keyframes shine{
  0%{left:-100%}
  100%{left:100%}
}

/* preview */
.preview{border:1px solid #ddd;border-radius:16px;overflow:hidden}
.poster{aspect-ratio:2/3;background:#eee}
.poster img{width:100%;height:100%;object-fit:cover}
.c{padding:16px;text-align:center}

/* brand & title buttons */
.brand-btn{background:#0D3B66;color:#fff;margin-top:8px}
.title-btn{background:#1f6fd6;color:#fff;margin-top:8px}

/* date */
.date-line{
  margin-top:10px;
  font-size:14px;
  color:#555;
  display:flex;
  justify-content:center;
  align-items:center;
  gap:8px;
}

/* pay */
.pay{
  margin-top:14px;padding:14px;
  border-radius:14px;
  background:#2FB344;color:#fff;
}
.disabled{opacity:.35;pointer-events:none}

/* video */
.video iframe{
  width:100%;
  aspect-ratio:16/9;
  border-radius:12px;
  border:none;
  margin-top:12px;
}

.actions{margin-top:14px;display:none}

@media(max-width:900px){
  .flex{flex-direction:column}
  .box{width:100%}
}
</style>
</head>

<body>

<div class="wrap" id="builder">
<div class="flex">

<!-- LEFT -->
<div class="box">
<h2>Create Landing</h2>

<label>Brand</label>
<input id="brand" oninput="sync()">

<label>Poster Image (Required)</label>
<input type="file" accept="image/*" onchange="loadImg(event)">

<label>Title</label>
<input id="title" oninput="sync()">

<label>Date & Time</label>
<input type="datetime-local" id="dt" oninput="sync()">

<label>YouTube Link (Optional)</label>
<input id="yt" oninput="sync()" placeholder="youtube / youtu.be / shorts">

<label>Payment Link</label>
<input id="pay">

<label>Description</label>
<textarea id="desc" oninput="sync()"></textarea>

<button class="primary anim" onclick="generate()">Generate Landing Page</button>

<div class="actions" id="actions">
  <button class="copy anim" onclick="copyLink()">Copy Landing Link</button>
  <button class="wa anim" onclick="shareWA()">Share on WhatsApp</button>
</div>
</div>

<!-- RIGHT -->
<div class="box">
<h3>Live Preview</h3>

<div class="preview" id="preview">
  <div class="poster" id="pimg"></div>
  <div class="c">
    <button class="brand-btn anim" id="pBrandBtn">Brand</button>
    <button class="title-btn anim" id="pTitleBtn">Title</button>

    <div class="date-line">
      <i class="fa-solid fa-calendar-days"></i>
      <span id="pdt"></span>
    </div>

    <p id="pdesc"></p>

    <div class="video" id="pvideo"></div>

    <div class="pay disabled">Pay Now (Preview)</div>
  </div>
</div>
</div>

</div>
</div>

<script>
let imageURL="", landingLink="";

/* YouTube ID extractor – FIX for error 153 */
function getYouTubeID(url){
  if(!url) return "";
  if(url.includes("youtu.be/")) return url.split("youtu.be/")[1].split(/[?&]/)[0];
  if(url.includes("v=")) return url.split("v=")[1].split("&")[0];
  if(url.includes("/shorts/")) return url.split("/shorts/")[1].split(/[?&]/)[0];
  if(url.includes("/embed/")) return url.split("/embed/")[1].split(/[?&]/)[0];
  return "";
}

function loadImg(e){
  imageURL=URL.createObjectURL(e.target.files[0]);
  pimg.innerHTML=`<img src="${imageURL}">`;
}

function sync(){
  pBrandBtn.innerText=brand.value||"Brand";
  pTitleBtn.innerText=title.value||"Title";
  pdt.innerText=dt.value;
  pdesc.innerText=desc.value;

  const vid=getYouTubeID(yt.value);
  if(vid){
    pvideo.innerHTML=`<iframe src="https://www.youtube.com/embed/${vid}" allowfullscreen></iframe>`;
  }else pvideo.innerHTML="";
}

function generate(){
  if(!imageURL||!pay.value) return alert("Image & payment link required");

  const id=Date.now();
  localStorage.setItem("landing_"+id,JSON.stringify({
    brand:brand.value,title:title.value,dt:dt.value,
    desc:desc.value,yt:yt.value,img:imageURL,pay:pay.value
  }));

  landingLink=location.origin+location.pathname+"?view=landing&id="+id;
  actions.style.display="block";
}

function copyLink(){
  navigator.clipboard.writeText(landingLink);
  alert("Link copied");
}

function shareWA(){
  window.open("https://wa.me/?text="+encodeURIComponent(landingLink));
}

/* LANDING MODE */
const q=new URLSearchParams(location.search);
if(q.get("view")==="landing"){
  const d=JSON.parse(localStorage.getItem("landing_"+q.get("id")));
  if(!d) document.body.innerHTML="Invalid Link";
  else{
    document.getElementById("builder").innerHTML=
    `<div class="box">
      <img src="${d.img}" style="width:100%;border-radius:16px">
      <button class="brand-btn anim">${d.brand}</button>
      <button class="title-btn anim">${d.title}</button>
      <div class="date-line"><i class="fa-solid fa-calendar-days"></i>${d.dt}</div>
      <p>${d.desc}</p>
      ${getYouTubeID(d.yt)?`<iframe src="https://www.youtube.com/embed/${getYouTubeID(d.yt)}" style="width:100%;aspect-ratio:16/9;border-radius:12px"></iframe>`:""}
      <a href="${d.pay}" class="pay" style="display:block;text-align:center;text-decoration:none">Pay Now</a>
    </div>`;
  }
}
</script>

</body>
</html>
